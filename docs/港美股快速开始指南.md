# Wondertrade æ¸¯ç¾è‚¡å¿«é€Ÿå¼€å§‹æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å¿«é€Ÿå¼€å§‹ä½¿ç”¨Wondertradeè¿›è¡Œæ¸¯ç¾è‚¡äº¤æ˜“ã€‚

## ç›®å½•

1. [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
2. [å®‰è£…ä¾èµ–](#å®‰è£…ä¾èµ–)
3. [é…ç½®å¯Œé€”OpenD](#é…ç½®å¯Œé€”opend)
4. [è¿è¡Œå›æµ‹æ¼”ç¤º](#è¿è¡Œå›æµ‹æ¼”ç¤º)
5. [å®ç›˜äº¤æ˜“è®¾ç½®](#å®ç›˜äº¤æ˜“è®¾ç½®)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ç¯å¢ƒå‡†å¤‡

### ç³»ç»Ÿè¦æ±‚

- Python 3.8+
- Windows 10/11 æˆ– macOS 10.14+ æˆ– Linux
- è‡³å°‘ 4GB RAM
- ç¨³å®šçš„ç½‘ç»œè¿æ¥

### å¯Œé€”è´¦æˆ·è¦æ±‚

- å¯Œé€”è¯åˆ¸è´¦æˆ·
- æ¸¯è‚¡æˆ–ç¾è‚¡äº¤æ˜“æƒé™
- å¯Œé€”ç‰›ç‰›å®¢æˆ·ç«¯

## å®‰è£…ä¾èµ–

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/wondertrader/wtpy.git
cd wtpy
```

### 2. å®‰è£…åŸºç¡€ä¾èµ–

```bash
pip install -r requirements.txt
```

### 3. å®‰è£…æ¸¯ç¾è‚¡æ”¯æŒ

```bash
python install_futu_support.py
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨å®‰è£…ï¼š
- futu-apiï¼ˆå¯Œé€”OpenAPIï¼‰
- talib-binaryï¼ˆæŠ€æœ¯åˆ†æåº“ï¼‰
- pyfolioï¼ˆå›æµ‹åˆ†æï¼Œå¯é€‰ï¼‰
- matplotlibï¼ˆå›¾è¡¨ç»˜åˆ¶ï¼Œå¯é€‰ï¼‰

## é…ç½®å¯Œé€”OpenD

### 1. ä¸‹è½½å¯Œé€”OpenD

è®¿é—® [å¯Œé€”å¼€æ”¾å¹³å°](https://openapi.futunn.com/futu-api-doc/) ä¸‹è½½OpenDç¨‹åºã€‚

### 2. å¯åŠ¨OpenD

1. è¿è¡Œå¯Œé€”ç‰›ç‰›å®¢æˆ·ç«¯å¹¶ç™»å½•
2. å¯åŠ¨OpenDç¨‹åº
3. ç¡®ä¿OpenDåœ¨ `127.0.0.1:11111` ç«¯å£è¿è¡Œ
4. æ£€æŸ¥è¿æ¥çŠ¶æ€ä¸º"å·²è¿æ¥"

### 3. éªŒè¯è¿æ¥

```python
from futu import *

# æµ‹è¯•è¿æ¥
quote_ctx = OpenQuoteContext(host='127.0.0.1', port=11111)
ret, data = quote_ctx.get_market_state([Market.HK, Market.US])
if ret == RET_OK:
    print("è¿æ¥æˆåŠŸï¼")
    print(data)
else:
    print("è¿æ¥å¤±è´¥ï¼š", data)
quote_ctx.close()
```

## è¿è¡Œå›æµ‹æ¼”ç¤º

### è…¾è®¯æ§è‚¡DualThrustç­–ç•¥å›æµ‹

```bash
cd demos/cta_hk_bt
python runBT.py
```

### å›æµ‹å‚æ•°è¯´æ˜

- **è‚¡ç¥¨ä»£ç **: HK.00700 (è…¾è®¯æ§è‚¡)
- **å›æµ‹æ—¶é—´**: 2023å¹´1æœˆ1æ—¥ - 2023å¹´12æœˆ31æ—¥
- **ç­–ç•¥**: DualThrustçªç ´ç­–ç•¥
- **Kçº¿å‘¨æœŸ**: 5åˆ†é’Ÿ
- **åˆå§‹èµ„é‡‘**: 500,000 æ¸¯å¸

### æŸ¥çœ‹å›æµ‹ç»“æœ

å›æµ‹å®Œæˆåï¼Œç»“æœä¿å­˜åœ¨ `./outputs_bt/dt_tencent/` ç›®å½•ï¼š

```
outputs_bt/dt_tencent/
â”œâ”€â”€ funds.csv          # èµ„é‡‘æ›²çº¿
â”œâ”€â”€ trades.csv         # äº¤æ˜“è®°å½•
â”œâ”€â”€ closes.csv         # å¹³ä»“è®°å½•
â”œâ”€â”€ signals.csv        # ä¿¡å·è®°å½•
â””â”€â”€ summary.json       # ç»Ÿè®¡æ‘˜è¦
```

### åˆ†æå›æµ‹ç»“æœ

ä½¿ç”¨å†…ç½®åˆ†æå·¥å…·ï¼š

```python
from wtpy.apps import WtBtAnalyst

analyst = WtBtAnalyst()
analyst.add_strategy('dt_tencent', folder='./outputs_bt/', 
                    init_capital=500000, rf=0.02, annual_trading_days=250)
analyst.run_new()
```

## å®ç›˜äº¤æ˜“è®¾ç½®

### 1. é…ç½®äº¤æ˜“å¯†ç 

ç¼–è¾‘ `demos/cta_hk_live/config.yaml`ï¼š

```yaml
futu:
  trade:
    unlock_password: "your_trade_password"  # å¡«å…¥æ‚¨çš„äº¤æ˜“å¯†ç 
    is_simulate: true                        # æ¨¡æ‹Ÿäº¤æ˜“ï¼Œè®¾ä¸ºfalseè¿›è¡ŒçœŸå®äº¤æ˜“
```

### 2. å¯åŠ¨å®ç›˜äº¤æ˜“

```bash
cd demos/cta_hk_live
python run.py
```

### 3. ç›‘æ§äº¤æ˜“çŠ¶æ€

å®ç›˜äº¤æ˜“å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç›‘æ§ï¼š

- æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ `./logs/live_trading.log`
- ä½¿ç”¨å¯Œé€”ç‰›ç‰›å®¢æˆ·ç«¯æŸ¥çœ‹æŒä»“å’Œäº¤æ˜“è®°å½•

### 4. é£é™©æ§åˆ¶

å®ç›˜äº¤æ˜“åŒ…å«ä»¥ä¸‹é£æ§æªæ–½ï¼š

- æœ€å¤§ä»“ä½é™åˆ¶ï¼š80%
- å•ç¬”æ­¢æŸï¼š5%
- æ—¥å†…äºæŸé™åˆ¶ï¼š10%
- è‡ªåŠ¨æ’¤å•ä¿æŠ¤

## ç­–ç•¥è‡ªå®šä¹‰

### ä¿®æ”¹ç­–ç•¥å‚æ•°

ç¼–è¾‘ `demos/Strategies/DualThrustHK.py`ï¼š

```python
strategy = StraDualThrustHK(
    name='dt_tencent_live',
    code='HK.00700',        # è‚¡ç¥¨ä»£ç 
    barCnt=50,              # Kçº¿æ•°é‡
    period='m5',            # Kçº¿å‘¨æœŸ
    days=30,                # å†å²æ•°æ®å¤©æ•°
    k1=0.7,                 # ä¸Šè½¨ç³»æ•°
    k2=0.7,                 # ä¸‹è½¨ç³»æ•°
    max_pos=500,            # æœ€å¤§æŒä»“
    stop_loss=0.03          # æ­¢æŸæ¯”ä¾‹
)
```

### æ·»åŠ æ–°è‚¡ç¥¨

1. åœ¨ `demos/common/hk_us_contracts.json` ä¸­æ·»åŠ åˆçº¦ä¿¡æ¯
2. åœ¨ `demos/common/hk_us_commodities.json` ä¸­æ·»åŠ å“ç§ä¿¡æ¯
3. åœ¨ `demos/common/fees_hk.json` ä¸­æ·»åŠ ä½£é‡‘é…ç½®

### åˆ›å»ºæ–°ç­–ç•¥

ç»§æ‰¿ `BaseCtaStrategy` ç±»ï¼š

```python
from wtpy import BaseCtaStrategy, CtaContext

class MyStrategy(BaseCtaStrategy):
    def __init__(self, name: str, code: str):
        BaseCtaStrategy.__init__(self, name)
        self.__code__ = code
    
    def on_init(self, context: CtaContext):
        # ç­–ç•¥åˆå§‹åŒ–
        context.stra_prepare_bars(self.__code__, "m5", 50, isMain=True)
    
    def on_calculate(self, context: CtaContext):
        # ç­–ç•¥è®¡ç®—é€»è¾‘
        pass
```

## å¸¸è§é—®é¢˜

### Q1: æ— æ³•è¿æ¥å¯Œé€”OpenD

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿å¯Œé€”ç‰›ç‰›å®¢æˆ·ç«¯å·²ç™»å½•
2. æ£€æŸ¥OpenDç¨‹åºæ˜¯å¦æ­£å¸¸è¿è¡Œ
3. éªŒè¯ç«¯å£11111æ˜¯å¦è¢«å ç”¨
4. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### Q2: å›æµ‹æ•°æ®ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥å¯Œé€”è´¦æˆ·çš„æ•°æ®æƒé™
2. ç¡®è®¤è‚¡ç¥¨ä»£ç æ ¼å¼æ­£ç¡®ï¼ˆå¦‚ï¼šHK.00700ï¼‰
3. è°ƒæ•´å›æµ‹æ—¶é—´èŒƒå›´
4. æ£€æŸ¥ç½‘ç»œè¿æ¥

### Q3: å®ç›˜äº¤æ˜“æ— æ³•ä¸‹å•

**è§£å†³æ–¹æ¡ˆ**:
1. éªŒè¯äº¤æ˜“å¯†ç æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥è´¦æˆ·èµ„é‡‘æ˜¯å¦å……è¶³
3. ç¡®è®¤è‚¡ç¥¨äº¤æ˜“æƒé™
4. æ£€æŸ¥äº¤æ˜“æ—¶é—´æ˜¯å¦åœ¨å¼€å¸‚æ—¶æ®µ

### Q4: ç­–ç•¥è¿è¡Œé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥ç­–ç•¥å‚æ•°è®¾ç½®
3. éªŒè¯åˆçº¦å’Œå“ç§é…ç½®æ–‡ä»¶
4. ç¡®è®¤Pythonä¾èµ–åŒ…ç‰ˆæœ¬å…¼å®¹æ€§

### Q5: æ€§èƒ½ä¼˜åŒ–

**å»ºè®®**:
1. ä½¿ç”¨SSDç¡¬ç›˜å­˜å‚¨æ•°æ®
2. å¢åŠ å†…å­˜é…ç½®
3. ä¼˜åŒ–ç­–ç•¥è®¡ç®—é€»è¾‘
4. åˆç†è®¾ç½®Kçº¿æ•°æ®ç¼“å­˜

## æŠ€æœ¯æ”¯æŒ

- **å®˜æ–¹æ–‡æ¡£**: [Wondertradeæ–‡æ¡£](https://wondertrader.github.io/)
- **å¯Œé€”APIæ–‡æ¡£**: [å¯Œé€”å¼€æ”¾å¹³å°](https://openapi.futunn.com/futu-api-doc/)
- **GitHub Issues**: [æäº¤é—®é¢˜](https://github.com/wondertrader/wtpy/issues)
- **QQç¾¤**: 610730738

## å…è´£å£°æ˜

æœ¬è½¯ä»¶ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚ä½¿ç”¨æœ¬è½¯ä»¶è¿›è¡Œå®ç›˜äº¤æ˜“çš„é£é™©ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…ã€‚è¯·åœ¨å……åˆ†äº†è§£ç›¸å…³é£é™©çš„å‰æä¸‹è°¨æ…ä½¿ç”¨ã€‚

---

**ç¥æ‚¨äº¤æ˜“æ„‰å¿«ï¼** ğŸš€